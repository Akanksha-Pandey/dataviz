```{r echo = FALSE, message = FALSE}
# run setup script
source("_common.R")
```

# Coordinate systems and axes

## Cartesian coordinates

Discuss aspect ratio, fixed vs. fluid

## Nonlinear axes

*Introduce the concept of logarithmic scales. They are linear in multiplication, a unit step on the scale corresponds to multiplication with a fixed factor.*


To explain the relationship between linear and logarithmic scales, Figure \@ref(fig:linear-log-scales) shows the numbers 1, 3.16, 10, 31.6, and 100 placed on different scales. The numbers 3.16 and 31.6 may seem a strange choice, but because they are exactly half-way between 1 and 10 and between 10 and 100 on a logarithmic scale. We can see this by observing that $10^{0.5} = \sqrt(10) \approx 3.16$ and equivalently $3.16 \times 3.16 \approx 10$. Similarly, $100^{0.5} \approx 31.6$.

(ref:linear-log-scales) Relationship between linear and logarithmic scales. The dots correspond to data values 1, 3.16, 10, 31.6, 100, which are evenly-spaced numbers on a logarithmic scale. We can display these data points on a linear scale, we can log-transform them and then show on a linear scale, or we can show them on a logarithmic scale. Importantly, the correct axis title for a logarithmic scale is the name of the variable shown, not the logarithm of that variable.

```{r linear-log-scales, fig.width = 7.5, fig.cap = '(ref:linear-log-scales)'}
df <- data.frame(x = c(1, 3.16, 10, 31.6, 100))

xaxis_lin <- ggplot(df, aes(x, y = 1)) + 
  geom_point(size = 3, color = "#0072B2") + 
  scale_y_continuous(limits = c(0.8, 1.2), expand = c(0, 0), breaks = 1) +
  theme_minimal_grid() +
  theme(axis.ticks.length = grid::unit(0, "pt"),
        axis.text.y = element_blank(),
        axis.title.y = element_blank(),
        axis.ticks.y = element_blank(),
        plot.title = element_text(face = "plain"),
        plot.margin = margin(3.5, 20, 3.5, 20))

xaxis_log <- ggplot(df, aes(log10(x), y = 1)) + 
  geom_point(size = 3, color = "#0072B2") + 
  scale_y_continuous(limits = c(0.8, 1.2), expand = c(0, 0), breaks = 1) +
  theme_minimal_grid() +
  theme(axis.ticks.length = grid::unit(0, "pt"),
        axis.text.y = element_blank(),
        axis.title.y = element_blank(),
        axis.ticks.y = element_blank(),
        plot.title = element_text(face = "plain"),
        plot.margin = margin(3.5, 20, 3.5, 20))

plotlist <- 
  align_plots(xaxis_lin + scale_x_continuous(limits = c(0, 100)) + 
                ggtitle("original data, linear scale"),
              xaxis_log + scale_x_continuous(limits = c(0, 2)) +
                xlab(expression(paste("log"["10"], "(x)"))) + 
                ggtitle("log-transformed data, linear scale"),
              xaxis_lin + scale_x_log10(limits = c(1, 100), breaks = c(1, 3.16, 10, 31.6, 100),
                                        labels = c("1", "3.16", "10", "3.16", "100")) + 
                ggtitle("original data, logarithmic scale"),
              xaxis_lin + scale_x_log10(limits = c(1, 100), breaks = c(1, 3.16, 10, 31.6, 100),
                                        labels = c("1", "3.16", "10", "3.16", "100")) +
                xlab(expression(paste("log"["10"], "(x)"))) + 
                ggtitle("logarithmic scale with incorrect axis title"),
              align = 'vh')

plot_grid(plotlist[[1]], plotlist[[2]], plotlist[[3]], stamp_bad(plotlist[[4]]), ncol = 1)

```

*A few sentences about square-root scales?*

## Polar coordinates

Make a figure of mean temperature across the year, as circular chart?

(ref:temperature-normals-cartesian) Daily temperature normals for four selected locations in the U.S. Death Valley, CA is the hottest place in the continental U.S. and Barrow, AK the coldest. Honolulu, HI and Chicago, IL were chosen as representative tropical and temperate locations, respectively. Source: NOAA.

```{r temperature-normals-cartesian, fig.cap = '(ref:temperature-normals-cartesian)'}
library(lubridate)
library(forcats)

temps <- filter(ncdc_normals,
                station_id %in% c(
                  "USW00014819", # Chicago, IL 60638
                  "USC00516128", # Honolulu, HI 96813
                  "USW00027502", # Barrow, AK 99723, coldest point in the US
                  "USC00042319" # Death Valley, CA 92328 hottest point in the US
                )) %>%
  mutate(location = fct_recode(factor(station_id),
                               "Chicago, IL" = "USW00014819",
                               "Honolulu, HI" = "USC00516128",
                               "Barrow, AK" = "USW00027502",
                               "Death Valley, CA" = "USC00042319"))

ggplot(temps, aes(x = date, y = temperature, color = location)) +
  geom_line(size = 1) +
  scale_x_date(name="date", expand=c(0, 0)) + 
  scale_y_continuous(limits = c(-30, 110), expand = c(0, 0),
                     breaks = seq(-30, 90, by=30),
                     name = "temperature (F)") +
  theme_minimal_grid()
```

(ref:temperature-normals-polar) Daily temperature normals for four selected locations in the U.S., shown in polar coordinates. The radial distance from the center point indicates the daily temperature in Farenheit, and the days of the year are arranged clockwise starting with Jan. 1st at the 12:00 position.

```{r temperature-normals-polar, fig.width = 7.5, fig.cap = '(ref:temperature-normals-polar)'}
ggplot(temps, aes(x = date, y = temperature, color = location)) +
  geom_line(size = 1) +
  scale_x_date(name="date", expand=c(0, 0)) + 
  scale_y_continuous(limits = c(-30, 110), expand = c(0, 0),
                     breaks = seq(-30, 90, by=30),
                     name = "temperature (F)") +
  theme_minimal() +
  coord_polar(theta = "x") +
  theme_minimal_grid()
```
