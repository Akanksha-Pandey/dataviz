```{r echo = FALSE, message = FALSE, warning = FALSE}
# run setup script
source("_common.R")
```

# Visualizing geospatial data {#geospatial-data}

Topics to cover:

- Explain basic concepts, latitude, longitude, meridians, parallels, etc.
- Projections (give Alaska example)
- Layers: outline, streets, topography, etc.
- Chloropleth maps, cartograms, etc.

## Projections

```{r world-orthographic, fig.width = 4.5, fig.asp = 1}
cenlat <- 40
cenlong <- 15

ocean_col <- "#56B4E950"
land_col <- "#E69F00B0"
graticule_col <- "grey30"
line_col <- "black"

draw_ocean(cenlat, cenlong, col = ocean_col, line_col = graticule_col, lwd = 0.25)
draw_land(map_polys$world, cenlat, cenlong, col = land_col, line_col = line_col, lwd = 0.5)
```


```{r world-longlat, fig.asp = 0.6}
world_sf <- sf::st_as_sf(rworldmap::getMap(resolution = "low"))

crs_longlat <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"

ggplot(world_sf) + 
  geom_sf(fill = "#E69F00B0", color = "black", size = 0.5/.pt) + 
  coord_sf(expand = FALSE, crs = crs_longlat) + 
  scale_x_continuous(
    name = "longitude",
    breaks = seq(-150, 150, by = 30),
    labels = parse(text = c("NA", "120 * degree * W", "NA", "60 * degree * W", "NA", "0 * degree",
                            "NA", "60 * degree * E", "NA", "120 * degree * E", "NA"))
  ) +
  scale_y_continuous(
    name = "latitude",
    breaks = seq(-75, 75, by = 15),
    labels = parse(text = c("NA", "60 * degree * S", "NA", "30 * degree * S", "NA", "0 * degree",
                            "NA", "30 * degree * N", "NA", "60 * degree * N", "NA"))
  ) +
  theme_dviz_grid(font_size = 12, rel_small = 1) +
  theme(
    panel.background = element_rect(fill = "#56B4E950"),
    panel.grid.major = element_line(color = "gray30", size = 0.25),
    axis.ticks = element_line(color = "gray30", size = 0.5/.pt)
  )
```

```{r usa-orthographic, fig.width = 4.5, fig.asp = 1}
cenlat <- 35
cenlong <- -130

draw_ocean(cenlat, cenlong, lwd = 0.25)
draw_land(map_polys$usa, cenlat, cenlong, col = "#FF0000B0") 
draw_land(map_polys$world_no_usa, cenlat, cenlong, col = "#C0C0C0B0") 
```

```{r usa-true-albers}
ggplot(us_states_geoms$true_albers) + 
  geom_sf(fill = "#E69F00B0", color = "black", size = 0.5/.pt) +
  coord_sf(label_axes = "-NEN") +
  scale_x_continuous(breaks = -20*c(3:10)) +
  scale_y_continuous(breaks = (1:9)*10) +
  theme_dviz_grid(font_size = 12, rel_small = 1) +
  theme(
    panel.background = element_rect(fill = "#56B4E950"),
    panel.grid.major = element_line(color = "gray30", size = 0.25),
    axis.ticks = element_line(color = "gray30", size = 0.5/.pt)
  )
```

```{r usa-albers}
ggplot(us_states_geoms$true_albers) + geom_sf(fill = "#56B4E9", color = "grey30", size = 0.3, alpha = 0.5)
# standard US Albers map, with AK artificially small
ggplot(us_states_geoms$us_albers) + geom_sf(fill = "#56B4E9", color = "grey30", size = 0.3, alpha = 0.5)
# revised US Albers map, with AK at its original size
ggplot(us_states_geoms$albers_revised) + geom_sf(fill = "#56B4E9", color = "grey30", size = 0.3, alpha = 0.5)
```

## Layers


## Choropleth mapping

## Cartograms and other map-like visualizations
